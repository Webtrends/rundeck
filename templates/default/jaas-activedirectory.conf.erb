activedirectory {
    com.dtolabs.rundeck.jetty.jaas.JettyCachingLdapLoginModule sufficient
    debug="<%=@ldap_debug.to_s%>"
    contextFactory="com.sun.jndi.ldap.LdapCtxFactory"
    providerUrl="<%=@ldap_provider%>"
    bindDn="<%=@ldap_binddn%>"
    bindPassword="<%=@ldap_bindpwd%>"
    authenticationMethod="<%=@ldap_authenticationmethod%>"
    forceBindingLogin="<%=@ldap_forcebindinglogin%>"
    userBaseDn="<%=@ldap_userbasedn%>"
    userRdnAttribute="<%=@ldap_userrdnattribute%>"
    userIdAttribute="<%=@ldap_useridattribute%>"
    userPasswordAttribute="<%=@ldap_userpasswordattribute%>"
    userObjectClass="<%=@ldap_userobjectclass%>"
    roleBaseDn="<%=@ldap_rolebasedn%>"
    roleNameAttribute="<%=@ldap_rolenameattribute%>"
<% if @ldap_roleusernamememberattribute -%>
    roleUsernameMemberAttribute="<%=@ldap_roleusernamememberattribute%>"
<% else -%>
    roleMemberAttribute="<%=@ldap_rolememberattribute%>"
<% end -%>
    roleObjectClass="<%=@ldap_roleobjectclass%>"
    rolePrefix="<%=@ldap_roleprefix%>"
    cacheDurationMillis="<%=@ldap_cachedurationmillis%>"
<% if @ldap_supplementalroles -%>
    supplementalRoles="<%=@ldap_supplementalroles%>"
<% end -%>
    reportStatistics="<%=@ldap_reportstatistics%>";

    org.eclipse.jetty.jaas.spi.PropertyFileLoginModule required
    useFirstPass="true"
    debug="<%=@ldap_debug.to_s%>"
    file="<%=@configdir%>/realm.properties";
};
