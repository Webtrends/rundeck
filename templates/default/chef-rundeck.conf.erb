start on runlevel [2345]
stop on shutdown
respawn
respawn limit 3 30

pre-start script
    if [ ! -d <%=@log_dir%> ]; then mkdir -p -m0755 <%=@log_dir%>; chown <%=@user%> <%=@log_dir%>; fi
    if [ ! -f <%=@log_dir%>/server.log ]; then touch <%=@log_dir%>/server.log; chown <%=@user%> <%=@log_dir%>/server.log; fi
end script
script
exec su - <%=@user%> -c "/opt/chef/embedded/bin/chef-rundeck -c <%=@chef_config%> -f <%=@project_config%> -w <%=@chef_webui_url%> -o <%=@chef_rundeck_host%> -p <%=@chef_rundeck_port%> <% if @chef_rundeck_partial_search %>--partial-search true<% end %> 2>&1" > <%=@log_dir%>/server.log
end script
