##############################################################################
# This file is autogenerated by chef                                         #
#                                                                            #
# Collectd Streaming API plugin configuration file                           #
#----------------------------------------------------------------------------#
# By: Josh Behrends - Webtrends 2012                                         #
#                                                                            #
# Revisions: 06/26/2012 - Initial script creation                            #
#                                                                            #
#                                                                            #
##############################################################################
LoadPlugin java

<Plugin "java">
        JVMArg "-verbose:jni"
        JVMArg "-Djava.class.path=/usr/share/collectd/java/collectd-api.jar:/usr/share/collectd/java/generic-jmx.jar"
        LoadPlugin "org.collectd.java.GenericJMX"
        <Plugin "GenericJMX">
        ################
        # MBean blocks #
        ################
		# Memory usage by memory pool.
		<MBean "memory_pool">
			ObjectName "java.lang:type=MemoryPool,*"
			InstancePrefix "memory_pool-"
			InstanceFrom "name"
			<Value>
				Type "memory"
				#InstancePrefix ""
				#InstanceFrom ""
				Table true
				Attribute "Usage"
			</Value>
		</MBean>	
		# Heap memory usage
		<MBean "memory-heap">
			ObjectName "java.lang:type=Memory"
			#InstanceFrom ""
			InstancePrefix "memory-heap"  
			# Creates four values: committed, init, max, used
			<Value>
				Type "memory"  
				#InstancePrefix ""
				#InstanceFrom ""
				Table true
				Attribute "HeapMemoryUsage"
			</Value>
		</MBean>
		# Non-heap memory usage
		<MBean "memory_nonheap">
			ObjectName "java.lang:type=Memory"
			#InstanceFrom ""
			InstancePrefix "memory-nonheap"
			# Creates four values: committed, init, max, used
			<Value>
				Type "memory"
				#InstancePrefix ""
				#InstanceFrom ""
				Table true
				Attribute "NonHeapMemoryUsage"
			</Value>
		</MBean>
		# Non-heap memory usage
		<MBean "java_threads">
			ObjectName "java.lang:type=Threading"
			#InstanceFrom ""
			InstancePrefix "java_threads"
			<Value>
				Type "gauge"
				InstancePrefix "ThreadCount"
				#InstanceFrom ""
				Attribute "ThreadCount"
			</Value>
		</MBean>	
		# Garbage Collector stats
		<MBean "garbage_collector">
			ObjectName "java.lang:type=GarbageCollector,*"
			InstancePrefix "gc-"
			InstanceFrom "name"
			<Value>
				Type "invocations"
				InstancePrefix "collection_count"
				#InstanceFrom ""
				Table false
				Attribute "CollectionCount"
			</Value>
			<Value>
				Type "total_time_in_ms"
				InstancePrefix "collection_time"
				#InstanceFrom ""
				Table false
				Attribute "CollectionTime"
			</Value>
		</MBean>
		# Number of classes being loaded.
		<MBean "classes">
			ObjectName "java.lang:type=ClassLoading"
			InstancePrefix "loaded_classes"
			#InstanceFrom ""
			<Value>
				Type "gauge"
				InstancePrefix "loaded_classes"
				#InstanceFrom ""
				Table false
				Attribute "LoadedClassCount"
			</Value>
		</MBean>
		# java runtime attributes
		<MBean "runtime">
			ObjectName "java.lang:type=Runtime"
			InstancePrefix "runtime"
			#InstanceFrom ""
			<Value>
				Type "gauge"
				InstancePrefix "JVM_uptime"
				#InstanceFrom ""
				Table false
				Attribute "Uptime"
			</Value>
		</MBean>		
		#WT Metrics
        <MBean "auth_handle-request">
			ObjectName "streamingapi:type=authentication,name=handle-request"
			InstancePrefix "SAPI_authentication_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Max"
				#InstanceFrom ""
				Table false
				Attribute "Max"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Mean"
				#InstanceFrom ""
				Table false
				Attribute "Mean"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Min"
				#InstanceFrom ""
				Table false
				Attribute "Min"
			</Value>
        </MBean>
        <MBean "auth_invalid-credentials">
			ObjectName "streamingapi:type=authentication,name=invalid-credentials"
			InstancePrefix "SAPI_authentication_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
        </MBean>
        <MBean "auth_requests-handled">
			ObjectName "streamingapi:type=authentication,name=requests-handled"
			InstancePrefix "SAPI_authentication_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
        </MBean>
        <MBean "metrics_active-channels">
			ObjectName "streamingapi:type=metricshandler,name=active-channels"
			InstancePrefix "SAPI_metricshandler_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Value"
				#InstanceFrom ""
				Table false
				Attribute "Value"
			</Value>
        </MBean>
        <MBean "metrics_handle-request">
			ObjectName "streamingapi:type=metricshandler,name=handle-request"
			InstancePrefix "SAPI_metricshandler_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Max"
				#InstanceFrom ""
				Table false
				Attribute "Max"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Mean"
				#InstanceFrom ""
				Table false
				Attribute "Mean"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Min"
				#InstanceFrom ""
				Table false
				Attribute "Min"
			</Value>
        </MBean>
        <MBean "metrics_handle-request-error">
			ObjectName "streamingapi:type=metricshandler,name=handle-request-error"
			InstancePrefix "SAPI_metricshandler_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
        </MBean>
        <MBean "metrics_requests-handled">
			ObjectName "streamingapi:type=metricshandler,name=requests-handled"
			InstancePrefix "SAPI_metricshandler_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
        </MBean>
        <MBean "collection-latency">
			ObjectName "streamingapi:type=latency,name=collection-latency"
			InstancePrefix "SAPI_latency_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Max"
				#InstanceFrom ""
				Table false
				Attribute "Max"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Min"
				#InstanceFrom ""
				Table false
				Attribute "Min"
			</Value>
            <Value>
				Type "gauge"
				InstancePrefix "Mean"
				#InstanceFrom ""
				Table false
				Attribute "Mean"
			</Value>
        </MBean>
        <MBean "source-latency">
			ObjectName "streamingapi:type=latency,name=source-latency"
			InstancePrefix "SAPI_latency_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Max"
				#InstanceFrom ""
				Table false
				Attribute "Max"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Min"
				#InstanceFrom ""
				Table false
				Attribute "Min"
			</Value>
            <Value>
				Type "gauge"
				InstancePrefix "Mean"
				#InstanceFrom ""
				Table false
				Attribute "Mean"
			</Value>
        </MBean>
        <MBean "socket_active-filter-channels">
			ObjectName "streamingapi:type=sockethandler,name=active-filter-channels"
			InstancePrefix "SAPI_sockethandler_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Value"
				#InstanceFrom ""
				Table false
				Attribute "Value"
			</Value>
        </MBean>
        <MBean "socket_handle-request">
			ObjectName "streamingapi:type=sockethandler,name=handle-request"
			InstancePrefix "SAPI_sockethandler_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Max"
				#InstanceFrom ""
				Table false
				Attribute "Max"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Mean"
				#InstanceFrom ""
				Table false
				Attribute "Mean"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "Min"
				#InstanceFrom ""
				Table false
				Attribute "Min"
			</Value>
        </MBean>
        <MBean "socket_handle-request-error">
			ObjectName "streamingapi:type=sockethandler,name=handle-request-error"
			InstancePrefix "SAPI_sockethandler_"
			InstanceFrom "name"
			<Value>
				Type "gauge"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
        </MBean>
        <MBean "socket_requests-handled">
			ObjectName "streamingapi:type=sockethandler,name=requests-handled"
			InstancePrefix "SAPI_sockethandler_"
			InstanceFrom "name"
			<Value>
				Type "counter"
				InstancePrefix "Count"
				#InstanceFrom ""
				Table false
				Attribute "Count"
			</Value>
			<Value>
				Type "gauge"
				InstancePrefix "MeanRate"
				#InstanceFrom ""
				Table false
				Attribute "MeanRate"
			</Value>
        </MBean>
        #####################
        # Connection blocks #
        #####################
        #Connection Block
        <Connection>
			Host "<%= @node[:hostname] %>"
			ServiceURL "service:jmx:rmi:///jndi/rmi://localhost:9999/jmxrmi"
			Collect "classes"
			Collect "garbage_collector"
			Collect "java_threads"
			Collect "memory-heap"
			Collect "memory_nonheap"
			Collect "runtime"
			Collect "auth_handle-request"
			Collect "auth_invalid-credentials"
			Collect "auth_requests-handled"
			Collect "metrics_active-channels"
			Collect "metrics_handle-request"
			Collect "metrics_handle-request-error"
			Collect "metrics_requests-handled"
			Collect "socket_active-filter-channels"
			Collect "socket_handle-request"
			Collect "socket_handle-request-error"
			Collect "socket_requests-handled"
            Collect "collection-latency"
            Collect "source-latency"
        </Connection>
        </Plugin>
</Plugin>
