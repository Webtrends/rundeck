##############################################################################
# This file is autogenerated by chef                                         #
#                                                                            #
# Collectd Kafka Broker plugin configuration file                            #
#----------------------------------------------------------------------------#
# By: Josh Behrends - Webtrends 2012                                         #
#                                                                            #
# Revisions: 06/12/2012 - Initial script creation                            #
#                                                                            #
##############################################################################
LoadPlugin java

<Plugin "java">
        JVMArg "-verbose:jni"
        JVMArg "-Djava.class.path=/usr/share/collectd/java/collectd-api.jar:/usr/share/collectd/java/generic-jmx.jar"
        LoadPlugin "org.collectd.java.GenericJMX"
        <Plugin "GenericJMX">
        ################
        # MBean blocks #
        ################
        <MBean "kafka_log-flush-stats">
                ObjectName "kafka:type=kafka.LogFlushStats"
                InstancePrefix "KafkaLogFlushStats"
                #InstanceFrom ""
                <Value>
                        Type "gauge"
                        InstancePrefix "AvgFlushMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "AvgFlushMs"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "FlushesPerSecond"
                        #InstanceFrom ""
                        Table false
                        Attribute "FlushesPerSecond"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "MaxFlushMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "MaxFlushMs"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "NumFlushes"
                        #InstanceFrom ""
                        Table false
                        Attribute "NumFlushes"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "TotalFlushMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "TotalFlushMs"
                </Value>
        </MBean>
        <MBean "kafka_socket-server-stats">
                ObjectName "kafka:type=kafka.SocketServerStats"
                InstancePrefix "KafkaSocketServerStats"
                #InstanceFrom ""
                <Value>
                        Type "gauge"
                        InstancePrefix "AvgFetchRequestMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "AvgFetchRequestMs"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "AvgProduceRequestMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "AvgProduceRequestMs"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "BytesReadPerSecond"
                        #InstanceFrom ""
                        Table false
                        Attribute "BytesReadPerSecond"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "BytesWrittenPerSecond"
                        #InstanceFrom ""
                        Table false
                        Attribute "BytesWrittenPerSecond"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "FetchRequestsPerSecond"
                        #InstanceFrom ""
                        Table false
                        Attribute "FetchRequestsPerSecond"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "MaxFetchRequestMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "MaxFetchRequestMs"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "NumFetchRequests"
                        #InstanceFrom ""
                        Table false
                        Attribute "NumFetchRequests"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "NumProduceRequests"
                        #InstanceFrom ""
                        Table false
                        Attribute "NumProduceRequests"
                </Value>
                <Value>
                        Type "gauge"
                        InstancePrefix "ProduceRequestsPerSecond"
                        #InstanceFrom ""
                        Table false
                        Attribute "ProduceRequestsPerSecond"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "TotalBytesRead"
                        #InstanceFrom ""
                        Table false
                        Attribute "TotalBytesRead"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "TotalBytesWritten"
                        #InstanceFrom ""
                        Table false
                        Attribute "TotalBytesWritten"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "TotalFetchRequestMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "TotalFetchRequestMs"
                </Value>
                <Value>
                        Type "counter"
                        InstancePrefix "TotalProduceRequestMs"
                        #InstanceFrom ""
                        Table false
                        Attribute "TotalProduceRequestMs"
                </Value>
        </MBean>
        #####################
        # Connection blocks #
        #####################
        #Connection Block
        <Connection>
                Host "<%= @node[:hostname] %>"
                ServiceURL "service:jmx:rmi:///jndi/rmi://localhost:9999/jmxrmi"
                Collect "kafka_socket-server-stats"
                Collect "kafka_log-flush-stats"
        </Connection>
        </Plugin>
</Plugin>
